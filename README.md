# Sort Utility

[![Go Version](https://img.shields.io/badge/go-1.21+-blue.svg)](https://golang.org/doc/install)
[![Coverage](https://img.shields.io/badge/coverage-85%25-brightgreen)](./coverage/coverage.html)

Утилита сортировки файлов, реализующая функциональность команды `sort` в Go.

## 🚀 Возможности

- ✅ **Базовая сортировка** - лексикографическая сортировка строк
- ✅ **Числовая сортировка** (`-n`) - сортировка как чисел
- ✅ **Сортировка по месяцам** (`-M`) - сортировка по названиям месяцев
- ✅ **Human-readable сортировка** (`-h`) - сортировка размеров файлов (K, M, G, T)
- ✅ **Сортировка по колонкам** (`-k`) - сортировка по указанной колонке
- ✅ **Обратная сортировка** (`-r`) - реверс результата
- ✅ **Удаление дубликатов** (`-u`) - только уникальные строки
- ✅ **Игнорирование пробелов** (`-b`) - пропуск хвостовых пробелов
- ✅ **Проверка сортировки** (`-c`) - проверка, отсортирован ли файл

## 📦 Установка

### Требования

- Go 1.21 или выше

### Сборка из исходного кода

```bash
# Клонирование репозитория
git clone https://github.com/rzmsq/sort_utility.git
cd sort_utility

# Установка зависимостей
make deps

# Сборка
make build

# Или установка в систему
make install
```

## 📖 Использование

### Базовый синтаксис

```bash
./bin/sort_utility [ОПЦИИ] ФАЙЛ
```

### Примеры

#### Базовая сортировка
```bash
./bin/sort_utility data.txt
```

#### Числовая сортировка
```bash
./bin/sort_utility -n numbers.txt
```

#### Сортировка по колонке с обратным порядком
```bash
./bin/sort_utility -k 2 -r users.txt
```

#### Удаление дубликатов
```bash
./bin/sort_utility -u duplicates.txt
```

#### Проверка, отсортирован ли файл
```bash
./bin/sort_utility -c sorted_file.txt
```

### 🔧 Опции

| Опция | Описание |
|-------|----------|
| `-n` | Числовая сортировка |
| `-r` | Обратная сортировка |
| `-u` | Удалить дубликаты |
| `-M` | Сортировка по месяцам |
| `-h` | Human-readable сортировка (K, M, G, T) |
| `-k N` | Сортировка по N-й колонке |
| `-b` | Игнорировать ведущие пробелы |
| `-c` | Проверить, отсортирован ли файл |

## 🏗️ Структура проекта

```
sort_utility/
├── cmd/
│   └── main.go                # Точка входа
├── internal/
│   ├── app/
│   │   ├── app.go            # Основная логика приложения
│   │   └── app_test.go       # Тесты app
│   ├── args/
│   │   ├── parser.go         # Парсинг аргументов
│   │   └── parser_test.go    # Тесты парсера
│   └── file/
│       ├── handler.go        # Обработка файлов и сортировка
│       └── handler_test.go   # Тесты обработчика файлов
├── coverage/                 # Отчеты о покрытии
├── bin/                      # Собранные бинарные файлы
├── Makefile                  # Автоматизация сборки
├── go.mod                    # Модуль Go
└── README.md                 # Документация
```

## 🛠️ Разработка

### Команды разработки

```bash
# Форматирование кода
make fmt

# Статический анализ
make vet
make lint

# Запуск тестов
make test

# Тесты с покрытием
make coverage

# Детальный анализ покрытия
make coverage-detailed

# Проверка качества кода
make check

# Строгая проверка с покрытием
make check-strict

# Создание примера для тестирования
make example

# Запуск с примером
make run

# Показать все команды
make help
```

### 📊 Покрытие тестами

Текущее покрытие: **85%+**

#### По компонентам:
- `cmd/main.go`: 80% - точка входа и обработка ошибок
- `internal/app/app.go`: 85% - основная логика приложения
- `internal/args/parser.go`: 96% - парсинг аргументов
- `internal/file/handler.go`: 90% - обработка файлов и сортировка

#### Критические функции:
- ✅ `SortFile` - основная функция сортировки
- ✅ `sortByColumn` - логика сортировки по колонкам
- ✅ `writeMsg` - функция вывода
- ✅ `main`, `errorExit` - точки входа

### Запуск тестов

```bash
# Все тесты
make test

# Тесты с покрытием
make coverage

# Проверка минимального покрытия (75%)
make coverage-check

# Детальный отчет по покрытию
make coverage-detailed
```

## ⚡ Производительность

### Бенчмарки

```bash
# Запуск бенчмарков
make bench

# С детекцией race condition
make race
```

## 🔄 Совместимость

Утилита совместима с основными флагами команды GNU `sort`:

| GNU sort | sort_utility | Статус |
|----------|--------------|--------|
| `-n` | `-n` | ✅ Реализовано |
| `-r` | `-r` | ✅ Реализовано |
| `-u` | `-u` | ✅ Реализовано |
| `-M` | `-M` | ✅ Реализовано |
| `-h` | `-h` | ✅ Реализовано |
| `-k` | `-k` | ✅ Реализовано |
| `-b` | `-b` | ✅ Реализовано |
| `-c` | `-c` | ✅ Реализовано |

## 🧪 Тестирование

### Создание тестовых файлов

```bash
# Создать пример для тестирования
make example

# Создать файл с числами
echo -e "10\n2\n1\n100" > numbers.txt

# Создать файл с размерами
echo -e "2K\n1M\n500\n1G" > sizes.txt

# Создать файл с пользователями  
echo -e "user1 30 admin\nuser2 25 user\nuser3 35 moderator" > users.txt
```